# Ensure 'ssh' connections time out correctly.

- name: integration/ssh/timeouts_wrapper.yml
  hosts: test-targets
  tasks:
    - connection: local
      command: ansible slow-connect-targets -m custom_python_detect_environment #debug -a msg="--{{ 69 + 42 }}--"
      register: out
      ignore_errors: true
      when: is_mitogen

    - assert:
        that:
        - |
          '"changed": false' in out.stdout
        - |
          '"unreachable": true' in out.stdout
        - |
          '"msg": "Connection timed out."' in out.stdout
      when: is_mitogen
